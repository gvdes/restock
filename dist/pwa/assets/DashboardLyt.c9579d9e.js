import{r as m,c as E,o as c,aE as I,f as o,d as e,w as a,h as w,aG as A,i as C,e as V,au as T,b as $,aK as ge,Q as M,t as r,aD as Q,R as ie,u as Z,a8 as _e,aF as H,aJ as de,x as be,a as re,g as ye}from"./index.a7959197.js";import{u as z,q as Y,e as J,y as W,z as U,A as F,x as P,s as K,t as le,Q as ee,a as te,B as ke,w as N,v as O,R,b as he,c as xe,d as we,f as $e,g as Se}from"./QCard.b5e0bbc0.js";import{d as j}from"./dayjs.min.16be2667.js";import{a as Ce,Q as Ve,b as De,c as qe,d as oe,e as Qe,f as se,g as Ie,u as ae}from"./Restock.9a8285fb.js";import{Q as X,C as ce}from"./ClosePopup.9dba6630.js";import"./axios.35a4834a.js";const Pe={class:"q-pa-sm bg-grey-2 text-bold row justify-between items-center",style:{"min-width":"250px"}},Ee=o("div",null,"Impresion",-1),Ue={key:0,class:"row justify-between items-center"},Re={class:"q-mt-sm q-pa-sm"},Ae={key:0,class:"q-pa-sm"},Le={class:"text--3"},je={class:"q-pa-sm text-right"},ne={__name:"PrinterSelect",emits:["selected"],setup(B,{emit:x}){const S=z(),b=Ce(),n=m(null),f=m(null),g=E(()=>b.printers),y=E(()=>n.value?n.value.printers:[]),v=()=>{S.localStorage.set("LUP",{wkp:n.value,printer:f.value}),x("selected",f.value)},_=S.localStorage.getItem("LUP");return _&&(n.value=_.wkp,f.value=_.printer),(D,h)=>(c(),I(A,null,[o("div",Pe,[Ee,n.value?(c(),I("div",Ue,[e(Ve,{flat:""},{default:a(()=>[e(w,{flat:"",color:"positive",icon:"add",dense:""}),f.value?(c(),I(A,{key:0},[e(w,{flat:"",color:"negative",icon:"delete",dense:""}),e(w,{flat:"",color:"orange",icon:"edit",dense:""})],64)):C("",!0)]),_:1})])):C("",!0)]),e(Y),o("div",Re,[e(J,{modelValue:n.value,"onUpdate:modelValue":[h[0]||(h[0]=k=>n.value=k),h[1]||(h[1]=k=>f.value=null)],options:V(g),label:"Sucursal",filled:"","option-label":"alias","option-value":"id"},null,8,["modelValue","options"])]),n.value?(c(),I("div",Ae,[e(J,{modelValue:f.value,"onUpdate:modelValue":h[2]||(h[2]=k=>f.value=k),options:V(y),label:"Impresora",filled:"","option-value":"id","option-label":"name"},{option:a(k=>[T((c(),$(W,ge({clickable:""},k.itemProps),{default:a(()=>[e(U,{class:"text-center",side:""},{default:a(()=>[e(M,{color:"primary","text-color":"white",name:"print",size:"30px"}),o("span",Le,"ID:"+r(k.opt.id),1)]),_:2},1024),e(U,null,{default:a(()=>[e(F,null,{default:a(()=>[Q(r(k.opt.name),1)]),_:2},1024),e(F,{caption:"",lines:"2"},{default:a(()=>[Q(r(k.opt.ip),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)),[[ie]])]),_:1},8,["modelValue","options"])])):C("",!0),o("div",je,[n.value&&f.value?(c(),$(w,{key:0,color:"primary",icon:"print",onClick:v})):C("",!0)])],64))}},Be=o("div",{class:"text-overline text-grey-7"},"Sucursal",-1),Ye={class:"text-h6"},Me={class:"q-px-lg text-center"},Oe=o("div",{class:"text-overline text-grey-7"},"Folio",-1),ze={class:"text-h6"},Ne={class:"text-right"},Te=o("div",{class:"text-overline text-grey-7"},"Agente",-1),Fe={class:"text-h6"},Ge={class:"text--1"},Ke={key:0},He=o("div",null,"Salida",-1),Je={class:"text-bold text-indigo-10"},We=o("div",null,"Entrada",-1),Xe={class:"text-bold text-orange-10"},Ze={class:"full-width row items-center"},et={class:"col text-dark"},tt={class:"text-h6"},at={class:"text-bold"},lt={key:1,class:"text-center q-pa-lg text-h6 text-grey-7"},ot=o("canvas",{id:"qrcode"},null,-1),st={class:"text--2"},nt=o("div",{class:"q-ml-md"},[o("div",{class:"text-h6"},"Emitir salida?"),o("div",null,"La salida emitira la factura correspondiente en Factusol.")],-1),it={__name:"OrderViewer",props:{head:{type:Object,default:{}}},emits:["loaded","loading"],setup(B,{emit:x}){const S=B,b=z();Z();const n=m(S.head),f=m(!0),g=m([]),y=m("basket"),v=m(null),_=m([]),D=m(!1),h=m({state:!1}),k=m({state:!1,key:null}),q=m([]),u=m({columns:[{name:"id",label:"ID",field:"id",align:"left",coldesc:"Identificador del producto (MySQL)"},{name:"code",label:"Codigo",field:"code",align:"left",coldesc:"Codigo principal del producto"},{name:"assocs",label:"Asociados",field:t=>t.variants.length?t.variants.map(l=>l.barcode).join(", "):null,align:"left",coldesc:"Codigos relacionados al codigo principal"},{name:"bcode",label:"Codigo de Barras",field:"barcode",align:"center",coldesc:"Codigo de barras principal"},{name:"locs",label:"Ubicacion",field:t=>t.locations.length?t.locations.map(l=>l.path).join(", "):"--",align:"left",coldesc:"Ubicaciones en almacen general"},{name:"stocks",label:"Stock (pzs)",field:t=>t.stocks.reduce((l,d)=>l+d.pivot.stock,0),sortable:!0,classes:t=>t.stocks.reduce((l,d)=>l+d.pivot.stock,0)<=0?"text-red text-bold":"text-bold text-primary",align:"center",coldesc:"Stock total en almacenes GENERALES (CEDIS+PAN)"},{name:"ipack",label:"PxC",field:t=>typeof t.pivot.ipack=="number"?t.pivot.ipack:t.pieces,align:"center",coldesc:"Unidades x Embalaje"},{name:"request",label:"Solicitud",field:t=>t.pivot.amount,align:"center",coldesc:"Embalaje solicitado"},{name:"uspply",label:"Unidad",field:t=>t.units.id==3?"Cajas":"Piezas",align:"left",coldesc:"Unidad de embalaje del producto"},{name:"delivery",label:"Salida (conteo)",field:t=>t.pivot.toDelivered,align:"center",coldesc:"Embalaje surtido",sortable:!0},{name:"reqinpzs",label:"Piezas",field:t=>t.pivot._supply_by==3?(typeof t.pivot.ipack=="number"?t.pivot.ipack:t.pieces)*(typeof t.pivot.ipack=="number"?t.pivot.toDelivered:t.pivot.amount):typeof t.pivot.ipack=="number"?t.pivot.toDelivered:t.pivot.amount,align:"center",coldesc:"Unidades totales en embalaje"},{name:"checkout",label:"Checkout",field:t=>t.pivot.checkout?"OK":"---",align:"center",classes:t=>t.pivot.checkout?"text-positive text-bold":"text-red",sortable:!0,coldesc:"Revision del Administrador"},{name:"received",label:"Entrada (conteo)",field:t=>t.pivot.toReceived,align:"center",coldesc:"Embalaje recibido"},{name:"descr",label:"Descripcion",field:"description",align:"left"},{name:"section",label:"Seccion",field:"section",align:"left"},{name:"family",label:"Familia",field:"family",align:"left"},{name:"category",label:"Categoria",field:"category",align:"left"}],filter:"",pagination:{sortBy:"locs",descending:!1,rowsPerPage:20}}),s=E(()=>_.value.reduce((t,l)=>t+(l.pivot._supply_by==3?l.pivot.amount*l.pieces:l.pivot.amount),0));E(()=>v.value&&(v.value.id==2||v.value.id==6));const i=E(()=>g.value.find(t=>t.id==v.value.id).pivot),p=async()=>{x("loading"),f.value=!0;let t=await R.order(n.value.id);console.log(t.data),_.value=t.data.products,g.value=t.data.log.map(l=>(l.pivot.details=JSON.parse(l.pivot.details),l)),v.value=t.data.status,k.value.key=t.data.entry_key,f.value=!1,x("loaded")},L=async()=>{x("loading"),D.value=!0;let t=3,l={id:n.value.id,state:t};const d=await R.nextState(l);d.status==200?(D.value=!1,b.notify({message:`Surtido iniciado para el pedido  ${n.value.id}`,icon:"done",position:"center",color:"teal"}),p()):alert(`Error ${d.status}: ${d.data}`),x("loaded")},G=async()=>{b.loading.show({message:"Generando, espera..."}),h.value.state=!1;const t=await R.genInvoice(n.value.id);console.log(t.data),t.status==200?t.data.invoice?p():alert("Error 500: Ocurrio un error inesperado :("):alert(`Error ${t.status}: ${t.data}`),b.loading.hide()},ue=async()=>{let t=`http://192.168.10.15:2200/#/checkin/${n.value.id}?key=${k.value.key}`;k.value.state=!0,be(()=>Ie.toCanvas(document.getElementById("qrcode"),t))},pe=async t=>{b.loading.show({message:"..."}),console.log(t);const l=await R.printKey({ip:t.ip,port:t._port,order:n.value.id});l.status==200?(l.data,b.loading.hide(),b.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"})):(console.error(l),alert(`Error ${l.status}: ${l.data}`))},ve=async t=>{b.loading.show({message:"..."}),console.log(t);const l=await R.printForSupply({ip:t.ip,port:t._port,order:n.value.id});console.log(l),l.status==200?(l.data?b.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"}):b.notify({message:`Sin conexion a <b>${t.name} <small>(${t.ip})</small></b>`,icon:"fas fa-bug",color:"negative",position:"center",html:!0,timeout:4e3}),b.loading.hide()):(console.error(l),alert(`Error ${l.status}: ${l.data}`))};return _e(()=>q.value=u.value.columns.map(t=>t.name)),p(),(t,l)=>(c(),I(A,null,[e(N,{class:"full-width"},{default:a(()=>[e(P,{class:"row justify-between"},{default:a(()=>[o("div",null,[Be,o("div",Ye,r(n.value.from.alias),1)]),o("div",Me,[Oe,o("div",ze,r(n.value.id),1)]),o("div",Ne,[Te,o("div",Fe,r(n.value.created_by.nick),1)])]),_:1}),e(Y),f.value?(c(),$(P,{key:0,class:"text-center"},{default:a(()=>[e(De,{size:"50px",color:"purple"})]),_:1})):(c(),I(A,{key:1},[e(P,{horizontal:"",class:"row"},{default:a(()=>[e(P,{class:"col"},{default:a(()=>[o("div",null,r(v.value.name),1),o("div",Ge,r(V(j)(V(i).updated_at).format("YYYY-MM-DD hh:mm A")),1),n.value.notes?(c(),I("div",Ke,[e(M,{name:"info",color:"pink-5",size:"20px"}),Q(r(n.value.notes),1)])):C("",!0)]),_:1}),v.value&&v.value.id>6?(c(),$(P,{key:0},{default:a(()=>[He,o("div",Je,r(n.value.invoice),1)]),_:1})):C("",!0),v.value&&v.value.id>9?(c(),$(P,{key:1},{default:a(()=>[We,o("div",Xe,r(n.value.invoice),1)]),_:1})):C("",!0),v.value&&v.value.id>1?(c(),$(X,{key:2,class:"col",align:"right"},{default:a(()=>[v.value&&v.value.id>6?(c(),$(w,{key:0,color:"pink-6",icon:"qr_code",dense:"",onClick:ue})):C("",!0),v.value&&v.value.id>2?(c(),$(w,{key:1,color:"indigo-10",icon:"print",dense:""},{default:a(()=>[e(K,{class:"bg-grey-1 text-indigo-10",style:{"min-width":"250px"}},{default:a(()=>[e(ne,{onSelected:ve})]),_:1})]),_:1})):C("",!0),v.value&&v.value.id==2?(c(),$(w,{key:2,color:"positive",icon:"start",dense:"",label:"Iniciar Surtido",onClick:L})):C("",!0),v.value&&v.value.id==6?(c(),$(w,{key:3,color:"pink",icon:"start",dense:"",label:"Emitir Salida",onClick:l[0]||(l[0]=d=>h.value.state=!0)})):C("",!0)]),_:1})):C("",!0)]),_:1}),e(Y),e(qe,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=d=>y.value=d),class:"text-pink-5",dense:"","no-caps":""},{default:a(()=>[e(oe,{name:"log",label:"Log"}),e(oe,{name:"basket",label:"Productos"})]),_:1},8,["modelValue"]),e(Qe,{modelValue:y.value,"onUpdate:modelValue":l[4]||(l[4]=d=>y.value=d),animated:""},{default:a(()=>[e(se,{name:"log"},{default:a(()=>[e(le,null,{default:a(()=>[(c(!0),I(A,null,H(g.value,d=>(c(),$(W,{key:d.id},{default:a(()=>[e(U,{avatar:""},{default:a(()=>[Q(r(d.id),1)]),_:2},1024),e(U,null,{default:a(()=>[Q(r(d.name),1)]),_:2},1024),e(U,null,{default:a(()=>[Q(r(d.pivot.details.responsable),1)]),_:2},1024),e(U,null,{default:a(()=>[Q("de "+r(V(j)(d.pivot.created_at).format("h:mm a"))+" a "+r(V(j)(d.pivot.updated_at).format("h:mm a")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(se,{name:"basket"},{default:a(()=>[_.value.length?(c(),$(ee,{key:0,"row-key":"id",flat:"",rows:_.value,columns:u.value.columns,pagination:u.value.pagination,filter:u.value.filter,"visible-columns":q.value},{top:a(()=>[o("div",Ze,[o("div",et,[o("span",tt,[e(w,{color:"pink-5",icon:"sync",onClick:p,round:"",dense:"",flat:""}),Q(" Productos: "+r(_.value.length),1)]),Q(", "),o("span",at,"Piezas: "+r(V(s)),1)]),e(te,{dense:"",modelValue:u.value.filter,"onUpdate:modelValue":l[2]||(l[2]=d=>u.value.filter=d),placeholder:"Buscar","input-class":"text-uppercase",color:"pink-5"},{append:a(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"]),e(w,{color:"secondary",icon:"fas fa-eye","no-caps":""},{default:a(()=>[e(K,{style:{"min-width":"200px"}},{default:a(()=>[e(le,null,{default:a(()=>[(c(!0),I(A,null,H(u.value.columns,(d,me)=>T((c(),$(W,{tag:"label",key:me},{default:a(()=>[e(U,null,{default:a(()=>[e(F,null,{default:a(()=>[Q(r(d.label),1)]),_:2},1024),e(F,{caption:""},{default:a(()=>[Q(r(d.coldesc),1)]),_:2},1024)]),_:2},1024),e(U,{side:"",top:""},{default:a(()=>[e(ke,{color:"pink-5",modelValue:q.value,"onUpdate:modelValue":l[3]||(l[3]=fe=>q.value=fe),val:d.name},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024)),[[ie]])),128))]),_:1})]),_:1})]),_:1})])]),_:1},8,["rows","columns","pagination","filter","visible-columns"])):(c(),I("div",lt,"Nada por aqui"))]),_:1})]),_:1},8,["modelValue"])],64))]),_:1}),e(O,{modelValue:k.value.state,"onUpdate:modelValue":l[5]||(l[5]=d=>k.value.state=d)},{default:a(()=>[e(N,null,{default:a(()=>[e(P,{class:"text-h6 text-center"},{default:a(()=>[Q(r(n.value.id)+" - "+r(n.value.from.alias),1)]),_:1}),e(Y),e(P,{class:"text-center"},{default:a(()=>[ot,o("div",st,r(k.value.key),1)]),_:1}),e(Y),e(P,{align:"center"},{default:a(()=>[e(w,{color:"indigo-10",icon:"print"},{default:a(()=>[e(K,null,{default:a(()=>[e(ne,{onSelected:pe})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,{modelValue:h.value.state,"onUpdate:modelValue":l[6]||(l[6]=d=>h.value.state=d)},{default:a(()=>[e(N,null,{default:a(()=>[e(P,{class:"row items-start"},{default:a(()=>[e(de,{icon:"warning",color:"orange-14","text-color":"white"}),nt]),_:1}),e(X,{align:"right"},{default:a(()=>[T(e(w,{flat:"",label:"Cancelar",color:"primary","no-caps":""},null,512),[[ce]]),e(w,{flat:"",label:"Continuar",color:"primary",onClick:G,"no-caps":""})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},dt={class:"text-h6"},rt={class:"row q-mt-md"},ct={class:"q-ml-sm text-h6"},ut={__name:"TableReport",props:{rows:{type:Array,default:[]},name:{type:String,default:""},type:{type:String,default:""}},emits:["cardResumeActived"],setup(B,{emit:x}){const S=B;ae();const b=z(),n=m({state:!1,action:null}),f=m({columns:[{name:"ID",field:"ID",label:"ID",align:"center"},{name:"code",field:"CODIGO",label:"Codigo",align:"center",sortable:!0},{name:"desc",field:"DESCRIPCION",label:"Descripcion",align:"left"},{name:"stockcedis",field:"CEDIS",label:"Stock (CEDIS)",align:"center",sortable:!0},{name:"stockpan",field:"PANTACO",label:"Stock (PAN)",align:"center",sortable:!0}],filter:""}),g={pndcs:{l:"Habilitar todo",c:"indigo-13",desc:"Los productos en esta lista se habilitaran y podran ser solicitados por cuaqluier tienda."},pdss:{l:"Deshabilitar todo",c:"pink-13",desc:"Los productos en esta lista se deshabilitaran y no podran ser solicitados."}},y=m(S.rows),v=m(S.name),_=m(S.type),D=E(()=>_.value?g[_.value]:{l:"",c:""}),h=()=>{const u=g[_.value];n.value.action=u,n.value.state=!0},k=async()=>{b.loading.show({message:"Espera..."});const u=await R.massiveAction({action:_.value});console.log(u),u.status==200?(u.data,n.value.state=!1,n.value.action=null,b.loading.hide(),b.notify({position:"center",color:"positive",icon:"done"}),x("cardResumeActived")):(console.error(u.data),alert(`Error ${u.status}: ${u.data.msg}`))},q=(u,s,i)=>{console.log(u),console.log(s),console.log(i),console.log(_.value)};return(u,s)=>(c(),I(A,null,[e(ee,{"row-key":"ID",rows:y.value,columns:f.value.columns,filter:f.value.filter,onRowClick:q},{top:a(()=>[o("div",dt,r(v.value),1),o("div",rt,[e(w,{color:V(D).c,icon:"warning",label:V(D).l,onClick:h},null,8,["color","label"]),e(te,{modelValue:f.value.filter,"onUpdate:modelValue":s[0]||(s[0]=i=>f.value.filter=i),dense:"",type:"text",icon:"search",label:"Buscar"},{prepend:a(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","columns","filter"]),e(O,{modelValue:n.value.state,"onUpdate:modelValue":s[1]||(s[1]=i=>n.value.state=i),persistent:""},{default:a(()=>[e(N,null,{default:a(()=>[e(P,{class:"row items-center"},{default:a(()=>[e(de,{icon:"warning",color:n.value.action.c,"text-color":"white"},null,8,["color"]),o("span",ct,r(n.value.action.l),1)]),_:1}),e(P,null,{default:a(()=>[Q(r(n.value.action.desc),1)]),_:1}),e(X,{align:"right"},{default:a(()=>[T(e(w,{flat:"",label:"cancelar",color:"primary"},null,512),[[ce]]),e(w,{flat:"",label:"continuar",color:"primary",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},pt={key:0,class:"bg-negative text-white q-pa-md q-mb-md"},vt=o("div",{class:"text-warning text-bold"},"Los siguientes folios tienen errores que no permiten ser listados en la tabla.",-1),mt={class:"text-h6"},ft=o("div",{class:"text--2"},"Errores comunes: Sin log, Sin fecha, Estatus desconocido",-1),gt={class:"row q-mb-md items-start justify-around"},_t={class:"text-left"},bt={class:"text-h5"},yt={class:"text--2"},kt={class:"full-width row items-center"},ht={class:"col text-h6 text-dark"},xt={__name:"AdminDashboard",emits:["reloadDashboard"],setup(B,{emit:x}){Z(),re();const S=ae(),b=z(),n=["text-grey-5 text-bold","text-bold text-h6 text-red","text-indigo","4","5","text-bold text-pink-7","text-orange-8","8","text-primary","text-positive"],f=m({columns:[{name:"id",label:"Folio",field:"id",align:"center",sortable:!0},{name:"state",label:"Estado",field:s=>s.log.length==1?s.log[0].name:s.log[s.log.length-1].name,align:"left",sortable:!0,sort:(s,i,p,L)=>parseInt(p._status)-parseInt(L._status),classes:s=>n[s._status-1]},{name:"laststate",label:"Ultima actividad",field:s=>j(s.log.find(i=>i.id==s.status.id).pivot.updated_at).format("YYYY-MM-DD hh:mm A"),align:"left"},{name:"from",label:"Sucursal",field:s=>s.from.name.toUpperCase(),align:"left",sortable:!0},{name:"to",label:"Destino",field:s=>s.to.name.toUpperCase(),align:"left",sortable:!0},{name:"notes",label:"Notas",field:s=>s.notes,align:"left",classes:s=>s.notes?"text-orange text-bold":""},{name:"tmodels",label:"Modelos",field:s=>s.products_count,align:"center",sortable:!0},{name:"invoice",label:"Salida",field:s=>{var i;return(i=s.invoice)!=null?i:null},align:"center",classes:"text-bold"},{name:"entry",label:"Entrada",field:s=>{var i;return(i=s.invoice_received)!=null?i:null},align:"center",classes:"text-bold"}],filter:"",pagination:{sortBy:"desc",descending:!1,rowsPerPage:20}}),g=m({state:!1,title:"",data:null,name:null,type:null}),y=m({state:!1,head:null,block:!0}),v=E(()=>S.ordersSize),_=E(()=>S.ordersok),D=E(()=>S.orderserrors),h=E(()=>S.resume),k=async(s,i,p)=>{y.value.head=i,y.value.state=!0},q=async s=>{b.loading.show({message:"cargando..."+s});const i=await R.report(s);console.log(i.data),g.value.data=i.data.rows,g.value.name=i.data.name,g.value.type=s,g.value.state=!0,b.loading.hide()},u=()=>{g.value.state=!1,g.state=!1,x("reload")};return(s,i)=>(c(),$(he,{padding:"",class:"bg-grey-2"},{default:a(()=>[V(D).length?(c(),I("div",pt,[vt,o("div",mt,r(V(D).map(p=>p.id).join("id")),1),ft])):C("",!0),o("div",gt,[(c(!0),I(A,null,H(V(h),p=>(c(),$(w,{stack:"","no-caps":"",class:"q-py-md",key:p.key,onClick:L=>q(p.key),color:p.total==0?"teal-10":"pink-13",disabled:p.total==0},{default:a(()=>[o("div",_t,[o("div",bt,r(p.total),1),o("div",yt,r(p.name),1)])]),_:2},1032,["onClick","color","disabled"]))),128))]),e(ee,{flat:"",bordered:"","row-key":"id",rows:V(_),columns:f.value.columns,filter:f.value.filter,pagination:f.value.pagination,onRowClick:k},{top:a(()=>[o("div",kt,[o("div",ht,"Pedidos: "+r(V(v)),1),e(te,{dense:"",modelValue:f.value.filter,"onUpdate:modelValue":i[0]||(i[0]=p=>f.value.filter=p),"input-class":"text-uppercase",placeholder:"Buscar",color:"pink-5"},{append:a(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","columns","filter","pagination"]),e(O,{"full-width":"",modelValue:y.value.state,"onUpdate:modelValue":i[3]||(i[3]=p=>y.value.state=p),persistent:y.value.block,"no-esc-dismiss":y.value.block,"no-backdrop-dismiss":y.value.block},{default:a(()=>[e(it,{head:y.value.head,onLoaded:i[1]||(i[1]=p=>y.value.block=!1),onLoading:i[2]||(i[2]=p=>y.value.block=!0)},null,8,["head"])]),_:1},8,["modelValue","persistent","no-esc-dismiss","no-backdrop-dismiss"]),e(O,{modelValue:g.value.state,"onUpdate:modelValue":i[4]||(i[4]=p=>g.value.state=p)},{default:a(()=>[e(ut,{rows:g.value.data,name:g.value.name,type:g.value.type,onCardResumeActived:u},null,8,["rows","name","type"])]),_:1},8,["modelValue"])]),_:1}))}};const wt=o("div",{class:"text-bold"},"Dashboard ",-1),$t={class:"row"},St={class:"col row"},Pt={__name:"DashboardLyt",setup(B){const x=Z(),S=re(),b=ae(),n=z(),f=m([{id:0,alias:"Todas"},{id:1,alias:"CEDIS",_state:1},{id:2,alias:"SP1",_state:1}]),g=m([{id:"day",label:"Hoy"},{id:"week",label:"Semana"},{id:"month",label:"Mes"},{id:"C",label:"otra ...",disable:!0}]),y=["p2","P2","p3","P3","bol","BOL","sap","SAP"],v=m(null),_=m(null),D=m({from:j(Date.now()).startOf("day"),to:j(Date.now()).startOf("day")}),h=async()=>{var L;n.loading.show({message:"Cargado vista..."}),console.log("%cIniciando MainLayout...","font-size:2em;color:orange;");let q=(L=x.query.v)!=null?L:"day",u=g.value.findIndex(G=>G.id==q),s=u>=0?u:0;_.value=g.value[s],D.value.from=j(Date.now()).startOf(_.value.id);let i=x.query.d&&y.includes(x.query.d)?x.query.d:"all";console.log(i);const p=await R.index(_.value.id,i);console.log(p),b.fillOrders(p.orders),b.fillResume(p.resume),b.fillPrinters(p.printers),v.value=f.value[0],console.log("%cMainLayout listo!!","font-size:2em;color:orange;"),n.loading.hide()},k=q=>{let u=x.query.d&&y.includes(x.query.d)?x.query.d:"all";S.push(`/dashboard?v=${q.id}&d=${u}`)};return E(()=>D.value.from.format("YYYY/MM/DD")),E(()=>D.value.to.format("YYYY/MM/DD")),ye(()=>x.query,()=>{h()}),h(),document.title="Dashboard",(q,u)=>(c(),$(xe,{view:"lHh Lpr lFf"},{default:a(()=>[e($e,{bordered:"",class:"transparent text-dark"},{default:a(()=>[e(we,{class:"row justify-between items-center"},{default:a(()=>[wt,o("div",$t,[e(w,{color:"pink-5",round:"",unelevated:"",flat:"",icon:"sync",onClick:h}),o("div",St,[e(J,{class:"col",dense:"",filled:"",label:"Vista",modelValue:_.value,"onUpdate:modelValue":[u[0]||(u[0]=s=>_.value=s),k],options:g.value},null,8,["modelValue","options"]),_.value.id=="C"?(c(),$(w,{key:0,unelevated:"",color:"pink-5",icon:"fas fa-calendar-day",dense:""})):C("",!0)])])]),_:1})]),_:1}),e(Se,null,{default:a(()=>[e(xt,{onReload:h})]),_:1})]),_:1}))}};export{Pt as default};
