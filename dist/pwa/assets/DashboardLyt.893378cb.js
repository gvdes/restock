import{r as m,c as E,o as v,aF as Q,f as s,d as e,w as a,h as k,aH as R,i as V,e as D,ax as N,b as S,aL as we,Q as T,t as p,aE as I,R as pe,u as oe,a8 as Se,aG as te,aJ as ve,x as $e,a as me,g as Ce}from"./index.42d1b508.js";import{u as G,o as Y,e as F,x as ae,y as U,z as W,v as C,w as J,p as ee,q as de,Q as se,a as ne,A as Ve,t as z,s as O,C as le,R as A,b as De,c as qe,d as Ie,f as Qe,g as Ee}from"./ClosePopup.b86ecf39.js";import{d as j}from"./dayjs.min.54da9cde.js";import{a as Pe,Q as Ue,b as Ae,c as Re,d as re,e as Le,f as ue,g as je,u as ie}from"./Restock.514456c4.js";import{A as K}from"./AssistApi.3dd7a6cb.js";import"./axios.073d26f8.js";const Be={class:"q-pa-sm bg-grey-2 text-bold row justify-between items-center",style:{"min-width":"250px"}},Me=s("div",null,"Impresion",-1),Oe={key:0,class:"row justify-between items-center"},Ye={class:"q-mt-sm q-pa-sm"},ze={key:0,class:"q-pa-sm"},Ne={class:"text--3"},Te={class:"q-pa-sm text-right"},ce={__name:"PrinterSelect",emits:["selected"],setup(B,{emit:x}){const $=G(),_=Pe(),u=m(null),f=m(null),n=E(()=>_.printers),y=E(()=>u.value?u.value.printers:[]),P=()=>{$.localStorage.set("LUP",{wkp:u.value,printer:f.value}),x("selected",f.value)},b=$.localStorage.getItem("LUP");return b&&(u.value=b.wkp,f.value=b.printer),(c,h)=>(v(),Q(R,null,[s("div",Be,[Me,u.value?(v(),Q("div",Oe,[e(Ue,{flat:""},{default:a(()=>[e(k,{flat:"",color:"positive",icon:"add",dense:""}),f.value?(v(),Q(R,{key:0},[e(k,{flat:"",color:"negative",icon:"delete",dense:""}),e(k,{flat:"",color:"orange",icon:"edit",dense:""})],64)):V("",!0)]),_:1})])):V("",!0)]),e(Y),s("div",Ye,[e(F,{modelValue:u.value,"onUpdate:modelValue":[h[0]||(h[0]=w=>u.value=w),h[1]||(h[1]=w=>f.value=null)],options:D(n),label:"Sucursal",filled:"","option-label":"alias","option-value":"id"},null,8,["modelValue","options"])]),u.value?(v(),Q("div",ze,[e(F,{modelValue:f.value,"onUpdate:modelValue":h[2]||(h[2]=w=>f.value=w),options:D(y),label:"Impresora",filled:"","option-value":"id","option-label":"name"},{option:a(w=>[N((v(),S(ae,we({clickable:""},w.itemProps),{default:a(()=>[e(U,{class:"text-center",side:""},{default:a(()=>[e(T,{color:"primary","text-color":"white",name:"print",size:"30px"}),s("span",Ne,"ID:"+p(w.opt.id),1)]),_:2},1024),e(U,null,{default:a(()=>[e(W,null,{default:a(()=>[I(p(w.opt.name),1)]),_:2},1024),e(W,{caption:"",lines:"2"},{default:a(()=>[I(p(w.opt.ip),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)),[[pe]])]),_:1},8,["modelValue","options"])])):V("",!0),s("div",Te,[u.value&&f.value?(v(),S(k,{key:0,color:"primary",icon:"print",onClick:P})):V("",!0)])],64))}},Fe=s("div",{class:"text-overline text-grey-7"},"Sucursal",-1),Ge={class:"text-h6"},He={class:"q-px-lg text-center"},Ke=s("div",{class:"text-overline text-grey-7"},"Folio",-1),Je={class:"text-h6"},We={class:"text-right"},Xe=s("div",{class:"text-overline text-grey-7"},"Agente",-1),Ze={class:"text-h6"},et={class:"text--1"},tt={key:0},at=s("div",null,"Salida",-1),lt={class:"text-bold text-indigo-10"},ot=s("div",null,"Entrada",-1),st={class:"text-bold text-orange-10"},nt={class:"full-width row items-center"},it={class:"col text-dark"},dt={class:"text-h6"},rt={class:"text-bold"},ut={key:1,class:"text-center q-pa-lg text-h6 text-grey-7"},ct=s("canvas",{id:"qrcode"},null,-1),pt={class:"text--2"},vt=s("div",{class:"q-ml-md"},[s("div",{class:"text-h6"},"Emitir salida?"),s("div",null,"La salida emitira la factura correspondiente en Factusol.")],-1),mt={__name:"OrderViewer",props:{head:{type:Object,default:{}}},emits:["loaded","loading"],setup(B,{emit:x}){const $=B,_=G();oe();const u=m({opts:[],val:[]}),f=m({opts:null,val:null}),n=m($.head),y=m(!0),P=m([]),b=m("basket"),c=m(null),h=m([]),w=m(!1),q=m({state:!1}),g=m({state:!1,key:null}),o=m({state:!1}),i=m([]),r=m({columns:[{name:"id",label:"ID",field:"id",align:"left",coldesc:"Identificador del producto (MySQL)"},{name:"code",label:"Codigo",field:"code",align:"left",coldesc:"Codigo principal del producto"},{name:"assocs",label:"Asociados",field:t=>t.variants.length?t.variants.map(l=>l.barcode).join(", "):null,align:"left",coldesc:"Codigos relacionados al codigo principal"},{name:"bcode",label:"Codigo de Barras",field:"barcode",align:"center",coldesc:"Codigo de barras principal"},{name:"locs",label:"Ubicacion",field:t=>t.locations.length?t.locations.map(l=>l.path).join(", "):"--",align:"left",coldesc:"Ubicaciones en almacen general"},{name:"stocks",label:"Stock (pzs)",field:t=>t.stocks.reduce((l,d)=>l+d.pivot.stock,0),sortable:!0,classes:t=>t.stocks.reduce((l,d)=>l+d.pivot.stock,0)<=0?"text-red text-bold":"text-bold text-primary",align:"center",coldesc:"Stock total en almacenes GENERALES (CEDIS+PAN)"},{name:"ipack",label:"PxC",field:t=>typeof t.pivot.ipack=="number"?t.pivot.ipack:t.pieces,align:"center",coldesc:"Unidades x Embalaje"},{name:"request",label:"Solicitud",field:t=>t.pivot.amount,align:"center",coldesc:"Embalaje solicitado"},{name:"uspply",label:"Unidad",field:t=>t.units.id==3?"Cajas":"Piezas",align:"left",coldesc:"Unidad de embalaje del producto"},{name:"delivery",label:"Salida (conteo)",field:t=>t.pivot.toDelivered,align:"center",coldesc:"Embalaje surtido",sortable:!0},{name:"reqinpzs",label:"Piezas",field:t=>t.pivot._supply_by==3?(typeof t.pivot.ipack=="number"?t.pivot.ipack:t.pieces)*(typeof t.pivot.ipack=="number"?t.pivot.toDelivered:t.pivot.amount):typeof t.pivot.ipack=="number"?t.pivot.toDelivered:t.pivot.amount,align:"center",coldesc:"Unidades totales en embalaje"},{name:"checkout",label:"Checkout",field:t=>t.pivot.checkout?"OK":"---",align:"center",classes:t=>t.pivot.checkout?"text-positive text-bold":"text-red",sortable:!0,coldesc:"Revision del Administrador"},{name:"received",label:"Entrada (conteo)",field:t=>t.pivot.toReceived,align:"center",coldesc:"Embalaje recibido"},{name:"descr",label:"Descripcion",field:"description",align:"left"},{name:"section",label:"Seccion",field:"section",align:"left"},{name:"family",label:"Familia",field:"family",align:"left"},{name:"category",label:"Categoria",field:"category",align:"left"}],filter:"",pagination:{sortBy:"locs",descending:!1,rowsPerPage:20}}),L=E(()=>h.value.reduce((t,l)=>t+(l.pivot._supply_by==3?l.pivot.amount*l.pieces:l.pivot.amount),0));E(()=>c.value&&(c.value.id==2||c.value.id==6));const X=E(()=>P.value.find(t=>t.id==c.value.id).pivot),H=async()=>{x("loading"),y.value=!0;let t=await A.order(n.value.id);console.log(t.data),h.value=t.data.products,P.value=t.data.log.map(l=>(l.pivot.details=JSON.parse(l.pivot.details),l)),c.value=t.data.status,g.value.key=t.data.entry_key,y.value=!1,x("loaded")},fe=()=>{o.value.state=!0},ge=async()=>{x("loading"),w.value=!0;let t=3,l={id:n.value.id,state:t};const d=await A.nextState(l);if(d.status==200){w.value=!1,_.notify({message:`Surtido iniciado para el pedido  ${n.value.id}`,icon:"done",position:"center",color:"teal"});let Z={supplyer:u.value.val,pedido:n.value.id,status:t},M=await K.SaveSupply(Z);console.log(M),M.status==200?(H(),o.value.state=!1):alert(`Error ${M.status}: ${M.data} 2`)}else alert(`Error ${d.status}: ${d.data} 1`);x("loaded")},_e=async()=>{_.loading.show({message:"Generando, espera..."}),q.value.state=!1;const t=await A.genInvoice(n.value.id);if(console.log(t),t.status==200){if(console.log(t),t.data.invoice){_.notify({message:`Se genero la salida <b class="text-h6">${t.data.invoice.folio}</b>`,html:!0,position:"center",icon:"done",timeout:5e3,color:"positive"});let l={supplyer:f.value.val,pedido:n.value.id,status:7},d=await K.SaveChofi(l);d.status==200?(H(),_.notify({message:"Pedido en ruta",position:"center",icon:"done",timeout:5e3,color:"positive"})):alert(`Error ${d.status}: ${d.data}`)}}else alert(`Error ${t.status}: ${t.data}`);_.loading.hide()},be=async()=>{let t=`http://192.168.10.189:2200/#/checkin/${n.value.id}?key=${g.value.key}`;g.value.state=!0,$e(()=>je.toCanvas(document.getElementById("qrcode"),t))},ye=async t=>{_.loading.show({message:"..."}),console.log(t);const l=await A.printKey({ip:t.ip,port:t._port,order:n.value.id});l.status==200?(l.data,_.loading.hide(),_.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"})):(console.error(l),alert(`Error ${l.status}: ${l.data}`))},he=async t=>{_.loading.show({message:"..."}),console.log(t);const l=await A.printForSupply({ip:t.ip,port:t._port,order:n.value.id});console.log(l),l.status==200?(l.data?_.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"}):_.notify({message:`Sin conexion a <b>${t.name} <small>(${t.ip})</small></b>`,icon:"fas fa-bug",color:"negative",position:"center",html:!0,timeout:4e3}),_.loading.hide()):(console.error(l),alert(`Error ${l.status}: ${l.data}`))},ke=async()=>{let t=await K.getSupply();console.log(t),u.value.opts=t},xe=async()=>{q.value.state=!0;let t=await K.getChof();console.log(t),f.value.opts=t.data};return Se(()=>i.value=r.value.columns.map(t=>t.name)),ke(),H(),(t,l)=>(v(),Q(R,null,[e(z,{class:"full-width"},{default:a(()=>[e(C,{class:"row justify-between"},{default:a(()=>[s("div",null,[Fe,s("div",Ge,p(n.value.from.alias),1)]),s("div",He,[Ke,s("div",Je,p(n.value.id),1)]),s("div",We,[Xe,s("div",Ze,p(n.value.created_by.nick),1)])]),_:1}),e(Y),y.value?(v(),S(C,{key:0,class:"text-center"},{default:a(()=>[e(Ae,{size:"50px",color:"purple"})]),_:1})):(v(),Q(R,{key:1},[e(C,{horizontal:"",class:"row"},{default:a(()=>[e(C,{class:"col"},{default:a(()=>[s("div",null,p(c.value.name),1),s("div",et,p(D(j)(D(X).updated_at).format("YYYY-MM-DD hh:mm A")),1),n.value.notes?(v(),Q("div",tt,[e(T,{name:"info",color:"pink-5",size:"20px"}),I(p(n.value.notes),1)])):V("",!0)]),_:1}),c.value&&c.value.id>6?(v(),S(C,{key:0},{default:a(()=>[at,s("div",lt,p(n.value.invoice),1)]),_:1})):V("",!0),c.value&&c.value.id>9?(v(),S(C,{key:1},{default:a(()=>[ot,s("div",st,p(n.value.invoice),1)]),_:1})):V("",!0),c.value&&c.value.id>1?(v(),S(J,{key:2,class:"col",align:"right"},{default:a(()=>[c.value&&c.value.id>6?(v(),S(k,{key:0,color:"pink-6",icon:"qr_code",dense:"",onClick:be})):V("",!0),c.value&&c.value.id>2?(v(),S(k,{key:1,color:"indigo-10",icon:"print",dense:""},{default:a(()=>[e(ee,{class:"bg-grey-1 text-indigo-10",style:{"min-width":"250px"}},{default:a(()=>[e(ce,{onSelected:he})]),_:1})]),_:1})):V("",!0),c.value&&c.value.id==2?(v(),S(k,{key:2,color:"positive",icon:"start",dense:"",label:"Iniciar Surtido",onClick:fe})):V("",!0),c.value&&c.value.id==6?(v(),S(k,{key:3,color:"pink",icon:"start",dense:"",label:"Emitir Salida",onClick:xe})):V("",!0)]),_:1})):V("",!0)]),_:1}),e(Y),e(Re,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=d=>b.value=d),class:"text-pink-5",dense:"","no-caps":""},{default:a(()=>[e(re,{name:"log",label:"Log"}),e(re,{name:"basket",label:"Productos"})]),_:1},8,["modelValue"]),e(Le,{modelValue:b.value,"onUpdate:modelValue":l[3]||(l[3]=d=>b.value=d),animated:""},{default:a(()=>[e(ue,{name:"log"},{default:a(()=>[e(de,null,{default:a(()=>[(v(!0),Q(R,null,te(P.value,d=>(v(),S(ae,{key:d.id},{default:a(()=>[e(U,{avatar:""},{default:a(()=>[I(p(d.id),1)]),_:2},1024),e(U,null,{default:a(()=>[I(p(d.name),1)]),_:2},1024),e(U,null,{default:a(()=>[I(p(d.pivot.details.responsable),1)]),_:2},1024),e(U,null,{default:a(()=>[I("de "+p(D(j)(d.pivot.created_at).format("h:mm a"))+" a "+p(D(j)(d.pivot.updated_at).format("h:mm a")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(ue,{name:"basket"},{default:a(()=>[h.value.length?(v(),S(se,{key:0,"row-key":"id",flat:"",rows:h.value,columns:r.value.columns,pagination:r.value.pagination,filter:r.value.filter,"visible-columns":i.value},{top:a(()=>[s("div",nt,[s("div",it,[s("span",dt,[e(k,{color:"pink-5",icon:"sync",onClick:H,round:"",dense:"",flat:""}),I(" Productos: "+p(h.value.length),1)]),I(", "),s("span",rt,"Piezas: "+p(D(L)),1)]),e(ne,{dense:"",modelValue:r.value.filter,"onUpdate:modelValue":l[1]||(l[1]=d=>r.value.filter=d),placeholder:"Buscar","input-class":"text-uppercase",color:"pink-5"},{append:a(()=>[e(T,{name:"search"})]),_:1},8,["modelValue"]),e(k,{color:"secondary",icon:"fas fa-eye","no-caps":""},{default:a(()=>[e(ee,{style:{"min-width":"200px"}},{default:a(()=>[e(de,null,{default:a(()=>[(v(!0),Q(R,null,te(r.value.columns,(d,Z)=>N((v(),S(ae,{tag:"label",key:Z},{default:a(()=>[e(U,null,{default:a(()=>[e(W,null,{default:a(()=>[I(p(d.label),1)]),_:2},1024),e(W,{caption:""},{default:a(()=>[I(p(d.coldesc),1)]),_:2},1024)]),_:2},1024),e(U,{side:"",top:""},{default:a(()=>[e(Ve,{color:"pink-5",modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=M=>i.value=M),val:d.name},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024)),[[pe]])),128))]),_:1})]),_:1})]),_:1})])]),_:1},8,["rows","columns","pagination","filter","visible-columns"])):(v(),Q("div",ut,"Nada por aqui"))]),_:1})]),_:1},8,["modelValue"])],64))]),_:1}),e(O,{modelValue:g.value.state,"onUpdate:modelValue":l[4]||(l[4]=d=>g.value.state=d)},{default:a(()=>[e(z,null,{default:a(()=>[e(C,{class:"text-h6 text-center"},{default:a(()=>[I(p(n.value.id)+" - "+p(n.value.from.alias),1)]),_:1}),e(Y),e(C,{class:"text-center"},{default:a(()=>[ct,s("div",pt,p(g.value.key),1)]),_:1}),e(Y),e(C,{align:"center"},{default:a(()=>[e(k,{color:"indigo-10",icon:"print"},{default:a(()=>[e(ee,null,{default:a(()=>[e(ce,{onSelected:ye})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,{modelValue:q.value.state,"onUpdate:modelValue":l[6]||(l[6]=d=>q.value.state=d)},{default:a(()=>[e(z,null,{default:a(()=>[e(C,{class:"row items-start"},{default:a(()=>[e(ve,{icon:"warning",color:"orange-14","text-color":"white"}),vt]),_:1}),e(C,null,{default:a(()=>[e(F,{modelValue:f.value.val,"onUpdate:modelValue":l[5]||(l[5]=d=>f.value.val=d),options:f.value.opts,label:"Chofer",filled:"","option-label":"complete_name"},null,8,["modelValue","options"])]),_:1}),e(J,{align:"right"},{default:a(()=>[N(e(k,{flat:"",label:"Cancelar",color:"primary","no-caps":""},null,512),[[le]]),e(k,{flat:"",label:"Continuar",color:"primary",onClick:_e,"no-caps":"",disable:f.value.val==null},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,{modelValue:o.value.state,"onUpdate:modelValue":l[8]||(l[8]=d=>o.value.state=d),persistent:""},{default:a(()=>[e(z,{style:{width:"400px"}},{default:a(()=>[e(C,{class:"row items-center"},{default:a(()=>[e(F,{modelValue:u.value.val,"onUpdate:modelValue":l[7]||(l[7]=d=>u.value.val=d),options:u.value.opts,label:"SELECCIONA SURTIDOR","option-label":"complete_name",filled:"",multiple:"",counter:"","max-values":"4",hint:"Maximo 4 colaboradores",style:{width:"100%"}},null,8,["modelValue","options"])]),_:1}),e(J,{align:"right"},{default:a(()=>[N(e(k,{flat:"",label:"Cancel",color:"primary"},null,512),[[le]]),e(k,{flat:"",label:"Continuar",color:"primary",onClick:ge,disable:u.value.val.length==0},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},ft={class:"text-h6"},gt={class:"row q-mt-md"},_t={class:"q-ml-sm text-h6"},bt={__name:"TableReport",props:{rows:{type:Array,default:[]},name:{type:String,default:""},type:{type:String,default:""}},emits:["cardResumeActived"],setup(B,{emit:x}){const $=B;ie();const _=G(),u=m({state:!1,action:null}),f=m({columns:[{name:"ID",field:"ID",label:"ID",align:"center"},{name:"code",field:"CODIGO",label:"Codigo",align:"center",sortable:!0},{name:"desc",field:"DESCRIPCION",label:"Descripcion",align:"left"},{name:"stockcedis",field:"CEDIS",label:"Stock (CEDIS)",align:"center",sortable:!0},{name:"stockpan",field:"PANTACO",label:"Stock (PAN)",align:"center",sortable:!0}],filter:""}),n={pndcs:{l:"Habilitar todo",c:"indigo-13",desc:"Los productos en esta lista se habilitaran y podran ser solicitados por cuaqluier tienda."},pdss:{l:"Deshabilitar todo",c:"pink-13",desc:"Los productos en esta lista se deshabilitaran y no podran ser solicitados."}},y=m($.rows),P=m($.name),b=m($.type),c=E(()=>b.value?n[b.value]:{l:"",c:""}),h=()=>{const g=n[b.value];u.value.action=g,u.value.state=!0},w=async()=>{_.loading.show({message:"Espera..."});const g=await A.massiveAction({action:b.value});console.log(g),g.status==200?(g.data,u.value.state=!1,u.value.action=null,_.loading.hide(),_.notify({position:"center",color:"positive",icon:"done"}),x("cardResumeActived")):(console.error(g.data),alert(`Error ${g.status}: ${g.data.msg}`))},q=(g,o,i)=>{console.log(g),console.log(o),console.log(i),console.log(b.value)};return(g,o)=>(v(),Q(R,null,[e(se,{"row-key":"ID",rows:y.value,columns:f.value.columns,filter:f.value.filter,onRowClick:q},{top:a(()=>[s("div",ft,p(P.value),1),s("div",gt,[e(k,{color:D(c).c,icon:"warning",label:D(c).l,onClick:h},null,8,["color","label"]),e(ne,{modelValue:f.value.filter,"onUpdate:modelValue":o[0]||(o[0]=i=>f.value.filter=i),dense:"",type:"text",icon:"search",label:"Buscar"},{prepend:a(()=>[e(T,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","columns","filter"]),e(O,{modelValue:u.value.state,"onUpdate:modelValue":o[1]||(o[1]=i=>u.value.state=i),persistent:""},{default:a(()=>[e(z,null,{default:a(()=>[e(C,{class:"row items-center"},{default:a(()=>[e(ve,{icon:"warning",color:u.value.action.c,"text-color":"white"},null,8,["color"]),s("span",_t,p(u.value.action.l),1)]),_:1}),e(C,null,{default:a(()=>[I(p(u.value.action.desc),1)]),_:1}),e(J,{align:"right"},{default:a(()=>[N(e(k,{flat:"",label:"cancelar",color:"primary"},null,512),[[le]]),e(k,{flat:"",label:"continuar",color:"primary",onClick:w})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},yt={key:0,class:"bg-negative text-white q-pa-md q-mb-md"},ht=s("div",{class:"text-warning text-bold"},"Los siguientes folios tienen errores que no permiten ser listados en la tabla.",-1),kt={class:"text-h6"},xt=s("div",{class:"text--2"},"Errores comunes: Sin log, Sin fecha, Estatus desconocido",-1),wt={class:"row q-mb-md items-start justify-around"},St={class:"text-left"},$t={class:"text-h5"},Ct={class:"text--2"},Vt={class:"full-width row items-center"},Dt={class:"col text-h6 text-dark"},qt={__name:"AdminDashboard",emits:["reloadDashboard"],setup(B,{emit:x}){oe(),me();const $=ie(),_=G(),u=["text-grey-5 text-bold","text-bold text-h6 text-red","text-indigo","4","5","text-bold text-pink-7","text-orange-8","8","text-primary","text-positive"],f=m({columns:[{name:"id",label:"Folio",field:"id",align:"center",sortable:!0},{name:"state",label:"Estado",field:o=>o.log.length==1?o.log[0].name:o.log[o.log.length-1].name,align:"left",sortable:!0,sort:(o,i,r,L)=>parseInt(r._status)-parseInt(L._status),classes:o=>u[o._status-1]},{name:"laststate",label:"Ultima actividad",field:o=>j(o.log.find(i=>i.id==o.status.id).pivot.updated_at).format("YYYY-MM-DD hh:mm A"),align:"left"},{name:"from",label:"Sucursal",field:o=>o.from.name.toUpperCase(),align:"left",sortable:!0},{name:"to",label:"Destino",field:o=>o.to.name.toUpperCase(),align:"left",sortable:!0},{name:"notes",label:"Notas",field:o=>o.notes,align:"left",classes:o=>o.notes?"text-orange text-bold":""},{name:"tmodels",label:"Modelos",field:o=>o.products_count,align:"center",sortable:!0},{name:"invoice",label:"Salida",field:o=>{var i;return(i=o.invoice)!=null?i:null},align:"center",classes:"text-bold"},{name:"entry",label:"Entrada",field:o=>{var i;return(i=o.invoice_received)!=null?i:null},align:"center",classes:"text-bold"}],filter:"",pagination:{sortBy:"desc",descending:!1,rowsPerPage:20}}),n=m({state:!1,title:"",data:null,name:null,type:null}),y=m({state:!1,head:null,block:!0}),P=E(()=>$.ordersSize),b=E(()=>$.ordersok),c=E(()=>$.orderserrors),h=E(()=>$.resume),w=async(o,i,r)=>{y.value.head=i,y.value.state=!0},q=async o=>{_.loading.show({message:"cargando..."+o});const i=await A.report(o);console.log(i.data),n.value.data=i.data.rows,n.value.name=i.data.name,n.value.type=o,n.value.state=!0,_.loading.hide()},g=()=>{n.value.state=!1,n.state=!1,x("reload")};return(o,i)=>(v(),S(De,{padding:"",class:"bg-grey-2"},{default:a(()=>[D(c).length?(v(),Q("div",yt,[ht,s("div",kt,p(D(c).map(r=>r.id).join("id")),1),xt])):V("",!0),s("div",wt,[(v(!0),Q(R,null,te(D(h),r=>(v(),S(k,{stack:"","no-caps":"",class:"q-py-md",key:r.key,onClick:L=>q(r.key),color:r.total==0?"teal-10":"pink-13",disabled:r.total==0},{default:a(()=>[s("div",St,[s("div",$t,p(r.total),1),s("div",Ct,p(r.name),1)])]),_:2},1032,["onClick","color","disabled"]))),128))]),e(se,{flat:"",bordered:"","row-key":"id",rows:D(b),columns:f.value.columns,filter:f.value.filter,pagination:f.value.pagination,onRowClick:w},{top:a(()=>[s("div",Vt,[s("div",Dt,"Pedidos: "+p(D(P)),1),e(ne,{dense:"",modelValue:f.value.filter,"onUpdate:modelValue":i[0]||(i[0]=r=>f.value.filter=r),"input-class":"text-uppercase",placeholder:"Buscar",color:"pink-5"},{append:a(()=>[e(T,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","columns","filter","pagination"]),e(O,{"full-width":"",modelValue:y.value.state,"onUpdate:modelValue":i[3]||(i[3]=r=>y.value.state=r),persistent:y.value.block,"no-esc-dismiss":y.value.block,"no-backdrop-dismiss":y.value.block},{default:a(()=>[e(mt,{head:y.value.head,onLoaded:i[1]||(i[1]=r=>y.value.block=!1),onLoading:i[2]||(i[2]=r=>y.value.block=!0)},null,8,["head"])]),_:1},8,["modelValue","persistent","no-esc-dismiss","no-backdrop-dismiss"]),e(O,{modelValue:n.value.state,"onUpdate:modelValue":i[4]||(i[4]=r=>n.value.state=r)},{default:a(()=>[e(bt,{rows:n.value.data,name:n.value.name,type:n.value.type,onCardResumeActived:g},null,8,["rows","name","type"])]),_:1},8,["modelValue"])]),_:1}))}};const It=s("div",{class:"text-bold"},"Dashboard ",-1),Qt={class:"row"},Et={class:"col row"},Bt={__name:"DashboardLyt",setup(B){const x=oe(),$=me(),_=ie(),u=G(),f=m([{id:0,alias:"Todas"},{id:1,alias:"CEDIS",_state:1},{id:2,alias:"SP1",_state:1}]),n=m([{id:"day",label:"Hoy"},{id:"week",label:"Semana"},{id:"month",label:"Mes"},{id:"C",label:"otra ...",disable:!0}]),y=["p2","P2","p3","P3","bol","BOL","sap","SAP"],P=m(null),b=m(null),c=m({from:j(Date.now()).startOf("day"),to:j(Date.now()).startOf("day")}),h=async()=>{var L;u.loading.show({message:"Cargado vista..."}),console.log("%cIniciando MainLayout...","font-size:2em;color:orange;");let q=(L=x.query.v)!=null?L:"day",g=n.value.findIndex(X=>X.id==q),o=g>=0?g:0;b.value=n.value[o],c.value.from=j(Date.now()).startOf(b.value.id);let i=x.query.d&&y.includes(x.query.d)?x.query.d:"all";console.log(i);const r=await A.index(b.value.id,i);console.log(r),_.fillOrders(r.orders),_.fillResume(r.resume),_.fillPrinters(r.printers),P.value=f.value[0],console.log("%cMainLayout listo!!","font-size:2em;color:orange;"),u.loading.hide()},w=q=>{let g=x.query.d&&y.includes(x.query.d)?x.query.d:"all";$.push(`/dashboard?v=${q.id}&d=${g}`)};return E(()=>c.value.from.format("YYYY/MM/DD")),E(()=>c.value.to.format("YYYY/MM/DD")),Ce(()=>x.query,()=>{h()}),h(),document.title="Dashboard",(q,g)=>(v(),S(qe,{view:"lHh Lpr lFf"},{default:a(()=>[e(Qe,{bordered:"",class:"bg-yellow text-dark"},{default:a(()=>[e(Ie,{class:"row justify-between items-center"},{default:a(()=>[It,s("div",Qt,[e(k,{color:"dark",round:"",unelevated:"",flat:"",icon:"sync",onClick:h}),s("div",Et,[e(F,{class:"col",dense:"",filled:"",label:"Vista",modelValue:b.value,"onUpdate:modelValue":[g[0]||(g[0]=o=>b.value=o),w],options:n.value},null,8,["modelValue","options"]),b.value.id=="C"?(v(),S(k,{key:0,unelevated:"",color:"pink-5",icon:"fas fa-calendar-day",dense:""})):V("",!0)])])]),_:1})]),_:1}),e(Ee,null,{default:a(()=>[e(qt,{onReload:h})]),_:1})]),_:1}))}};export{Bt as default};
