import{B as E,i as Nt,f as Yt,g as Ht,C as kt,D as pt,u as Lt,s as ue,a as ze,Q as Ft,w as qt}from"./QTable.33269f88.js";import{c as I,aS as rt,aT as Vt,F as Ut,r as p,g as ne,B as A,T as se,E as $t,m as jt,ah as Pt,x as We,h as L,o as Bt,b as Qt,w as Q,u as Zt,f as ye,t as Gt,d as x,Q as zt}from"./index.80432747.js";import{Q as Wt,a as Xt,b as Xe,c as Jt}from"./QCardActions.eba9662c.js";import{u as Kt}from"./use-cache.b0833c75.js";import{Q as ea}from"./QPage.82e7df4a.js";import{A as Je}from"./AssistApi.d49e53f7.js";import{d as ta}from"./dayjs.min.25545ff6.js";import{E as aa}from"./exceljs.min.9e24d01d.js";import"./rtl.f94ed350.js";import"./axios.10c2b4ae.js";import"./_commonjsHelpers.88e99c8f.js";const z=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function na(e,o,u){return Object.prototype.toString.call(e)==="[object Date]"&&(u=e.getDate(),o=e.getMonth()+1,e=e.getFullYear()),ua(He(e,o,u))}function Ke(e,o,u){return st(ra(e,o,u))}function oa(e){return la(e)===0}function De(e,o){return o<=6?31:o<=11||oa(e)?30:29}function la(e){const o=z.length;let u=z[0],s,i,l,y,d;if(e<u||e>=z[o-1])throw new Error("Invalid Jalaali year "+e);for(d=1;d<o&&(s=z[d],i=s-u,!(e<s));d+=1)u=s;return y=e-u,i-y<6&&(y=y-i+S(i+4,33)*33),l=F(F(y+1,33)-1,4),l===-1&&(l=4),l}function ut(e,o){const u=z.length,s=e+621;let i=-14,l=z[0],y,d,g,O,m;if(e<l||e>=z[u-1])throw new Error("Invalid Jalaali year "+e);for(m=1;m<u&&(y=z[m],d=y-l,!(e<y));m+=1)i=i+S(d,33)*8+S(F(d,33),4),l=y;O=e-l,i=i+S(O,33)*8+S(F(O,33)+3,4),F(d,33)===4&&d-O===4&&(i+=1);const M=S(s,4)-S((S(s,100)+1)*3,4)-150,R=20+i-M;return o||(d-O<6&&(O=O-d+S(d+4,33)*33),g=F(F(O+1,33)-1,4),g===-1&&(g=4)),{leap:g,gy:s,march:R}}function ra(e,o,u){const s=ut(e,!0);return He(s.gy,3,s.march)+(o-1)*31-S(o,7)*(o-7)+u-1}function ua(e){const o=st(e).gy;let u=o-621,s,i,l;const y=ut(u,!1),d=He(o,3,y.march);if(l=e-d,l>=0){if(l<=185)return i=1+S(l,31),s=F(l,31)+1,{jy:u,jm:i,jd:s};l-=186}else u-=1,l+=179,y.leap===1&&(l+=1);return i=7+S(l,30),s=F(l,30)+1,{jy:u,jm:i,jd:s}}function He(e,o,u){let s=S((e+S(o-8,6)+100100)*1461,4)+S(153*F(o+9,12)+2,5)+u-34840408;return s=s-S(S(e+100100+S(o-8,6),100)*3,4)+752,s}function st(e){let o=4*e+139361631;o=o+S(S(4*e+183187720,146097)*3,4)*4-3908;const u=S(F(o,1461),4)*5+308,s=S(F(u,153),5)+1,i=F(S(u,153),12)+1;return{gy:S(o,1461)-100100+S(8-i,6),gm:i,gd:s}}function S(e,o){return~~(e/o)}function F(e,o){return e-~~(e/o)*o}const sa=["gregorian","persian"],ia={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>sa.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},da=["update:modelValue"];function Z(e){return e.year+"/"+E(e.month)+"/"+E(e.day)}function ca(e,o){const u=I(()=>e.disable!==!0&&e.readonly!==!0),s=I(()=>e.editable===!0?0:-1),i=I(()=>{const d=[];return e.color!==void 0&&d.push(`bg-${e.color}`),e.textColor!==void 0&&d.push(`text-${e.textColor}`),d.join(" ")});function l(){return e.locale!==void 0?{...o.lang.date,...e.locale}:o.lang.date}function y(d){const g=new Date,O=d===!0?null:0;if(e.calendar==="persian"){const m=na(g);return{year:m.jy,month:m.jm,day:m.jd}}return{year:g.getFullYear(),month:g.getMonth()+1,day:g.getDate(),hour:O,minute:O,second:O,millisecond:O}}return{editable:u,tabindex:s,headerClass:i,getLocale:l,getCurrentDate:y}}const it=864e5,va=36e5,Ye=6e4,dt="YYYY-MM-DDTHH:mm:ss.SSSZ",fa=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,ma=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,xe={};function ha(e,o){const u="("+o.days.join("|")+")",s=e+u;if(xe[s]!==void 0)return xe[s];const i="("+o.daysShort.join("|")+")",l="("+o.months.join("|")+")",y="("+o.monthsShort.join("|")+")",d={};let g=0;const O=e.replace(ma,M=>{switch(g++,M){case"YY":return d.YY=g,"(-?\\d{1,2})";case"YYYY":return d.YYYY=g,"(-?\\d{1,4})";case"M":return d.M=g,"(\\d{1,2})";case"MM":return d.M=g,"(\\d{2})";case"MMM":return d.MMM=g,y;case"MMMM":return d.MMMM=g,l;case"D":return d.D=g,"(\\d{1,2})";case"Do":return d.D=g++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return d.D=g,"(\\d{2})";case"H":return d.H=g,"(\\d{1,2})";case"HH":return d.H=g,"(\\d{2})";case"h":return d.h=g,"(\\d{1,2})";case"hh":return d.h=g,"(\\d{2})";case"m":return d.m=g,"(\\d{1,2})";case"mm":return d.m=g,"(\\d{2})";case"s":return d.s=g,"(\\d{1,2})";case"ss":return d.s=g,"(\\d{2})";case"S":return d.S=g,"(\\d{1})";case"SS":return d.S=g,"(\\d{2})";case"SSS":return d.S=g,"(\\d{3})";case"A":return d.A=g,"(AM|PM)";case"a":return d.a=g,"(am|pm)";case"aa":return d.aa=g,"(a\\.m\\.|p\\.m\\.)";case"ddd":return i;case"dddd":return u;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return d.Z=g,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return d.ZZ=g,"(Z|[+-]\\d{2}\\d{2})";case"X":return d.X=g,"(-?\\d+)";case"x":return d.x=g,"(-?\\d{4,})";default:return g--,M[0]==="["&&(M=M.substring(1,M.length-1)),M.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),m={map:d,regex:new RegExp("^"+O)};return xe[s]=m,m}function ct(e,o){return e!==void 0?e:o!==void 0?o.date:Vt.date}function et(e,o=""){const u=e>0?"-":"+",s=Math.abs(e),i=Math.floor(s/60),l=s%60;return u+E(i)+o+E(l)}function ga(e,o,u,s,i){const l={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(i!==void 0&&Object.assign(l,i),e==null||e===""||typeof e!="string")return l;o===void 0&&(o=dt);const y=ct(u,rt.props),d=y.months,g=y.monthsShort,{regex:O,map:m}=ha(o,y),M=e.match(O);if(M===null)return l;let R="";if(m.X!==void 0||m.x!==void 0){const r=parseInt(M[m.X!==void 0?m.X:m.x],10);if(isNaN(r)===!0||r<0)return l;const f=new Date(r*(m.X!==void 0?1e3:1));l.year=f.getFullYear(),l.month=f.getMonth()+1,l.day=f.getDate(),l.hour=f.getHours(),l.minute=f.getMinutes(),l.second=f.getSeconds(),l.millisecond=f.getMilliseconds()}else{if(m.YYYY!==void 0)l.year=parseInt(M[m.YYYY],10);else if(m.YY!==void 0){const r=parseInt(M[m.YY],10);l.year=r<0?r:2e3+r}if(m.M!==void 0){if(l.month=parseInt(M[m.M],10),l.month<1||l.month>12)return l}else m.MMM!==void 0?l.month=g.indexOf(M[m.MMM])+1:m.MMMM!==void 0&&(l.month=d.indexOf(M[m.MMMM])+1);if(m.D!==void 0){if(l.day=parseInt(M[m.D],10),l.year===null||l.month===null||l.day<1)return l;const r=s!=="persian"?new Date(l.year,l.month,0).getDate():De(l.year,l.month);if(l.day>r)return l}m.H!==void 0?l.hour=parseInt(M[m.H],10)%24:m.h!==void 0&&(l.hour=parseInt(M[m.h],10)%12,(m.A&&M[m.A]==="PM"||m.a&&M[m.a]==="pm"||m.aa&&M[m.aa]==="p.m.")&&(l.hour+=12),l.hour=l.hour%24),m.m!==void 0&&(l.minute=parseInt(M[m.m],10)%60),m.s!==void 0&&(l.second=parseInt(M[m.s],10)%60),m.S!==void 0&&(l.millisecond=parseInt(M[m.S],10)*10**(3-M[m.S].length)),(m.Z!==void 0||m.ZZ!==void 0)&&(R=m.Z!==void 0?M[m.Z].replace(":",""):M[m.ZZ],l.timezoneOffset=(R[0]==="+"?-1:1)*(60*R.slice(1,3)+1*R.slice(3,5)))}return l.dateHash=E(l.year,6)+"/"+E(l.month)+"/"+E(l.day),l.timeHash=E(l.hour)+":"+E(l.minute)+":"+E(l.second)+R,l}function tt(e){const o=new Date(e.getFullYear(),e.getMonth(),e.getDate());o.setDate(o.getDate()-(o.getDay()+6)%7+3);const u=new Date(o.getFullYear(),0,4);u.setDate(u.getDate()-(u.getDay()+6)%7+3);const s=o.getTimezoneOffset()-u.getTimezoneOffset();o.setHours(o.getHours()-s);const i=(o-u)/(it*7);return 1+Math.floor(i)}function P(e,o,u){const s=new Date(e),i=`set${u===!0?"UTC":""}`;switch(o){case"year":case"years":s[`${i}Month`](0);case"month":case"months":s[`${i}Date`](1);case"day":case"days":case"date":s[`${i}Hours`](0);case"hour":case"hours":s[`${i}Minutes`](0);case"minute":case"minutes":s[`${i}Seconds`](0);case"second":case"seconds":s[`${i}Milliseconds`](0)}return s}function ge(e,o,u){return(e.getTime()-e.getTimezoneOffset()*Ye-(o.getTime()-o.getTimezoneOffset()*Ye))/u}function vt(e,o,u="days"){const s=new Date(e),i=new Date(o);switch(u){case"years":case"year":return s.getFullYear()-i.getFullYear();case"months":case"month":return(s.getFullYear()-i.getFullYear())*12+s.getMonth()-i.getMonth();case"days":case"day":case"date":return ge(P(s,"day"),P(i,"day"),it);case"hours":case"hour":return ge(P(s,"hour"),P(i,"hour"),va);case"minutes":case"minute":return ge(P(s,"minute"),P(i,"minute"),Ye);case"seconds":case"second":return ge(P(s,"second"),P(i,"second"),1e3)}}function at(e){return vt(e,P(e,"year"),"days")+1}function nt(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const ot={YY(e,o,u){const s=this.YYYY(e,o,u)%100;return s>=0?E(s):"-"+E(Math.abs(s))},YYYY(e,o,u){return u!=null?u:e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return E(e.getMonth()+1)},MMM(e,o){return o.monthsShort[e.getMonth()]},MMMM(e,o){return o.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return nt(this.Q(e))},D(e){return e.getDate()},Do(e){return nt(e.getDate())},DD(e){return E(e.getDate())},DDD(e){return at(e)},DDDD(e){return E(at(e),3)},d(e){return e.getDay()},dd(e,o){return this.dddd(e,o).slice(0,2)},ddd(e,o){return o.daysShort[e.getDay()]},dddd(e,o){return o.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return tt(e)},ww(e){return E(tt(e))},H(e){return e.getHours()},HH(e){return E(e.getHours())},h(e){const o=e.getHours();return o===0?12:o>12?o%12:o},hh(e){return E(this.h(e))},m(e){return e.getMinutes()},mm(e){return E(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return E(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return E(Math.floor(e.getMilliseconds()/10))},SSS(e){return E(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,o,u,s){const i=s==null?e.getTimezoneOffset():s;return et(i,":")},ZZ(e,o,u,s){const i=s==null?e.getTimezoneOffset():s;return et(i)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function ya(e,o,u,s,i){if(e!==0&&!e||e===1/0||e===-1/0)return;const l=new Date(e);if(isNaN(l))return;o===void 0&&(o=dt);const y=ct(u,rt.props);return o.replace(fa,(d,g)=>d in ot?ot[d](l,y,s,i):g===void 0?d:g.split("\\]").join("]"))}const J=20,Da=["Calendar","Years","Months"],lt=e=>Da.includes(e),Ne=e=>/^-?[\d]+\/[0-1]\d$/.test(e),oe=" \u2014 ";function G(e){return e.year+"/"+E(e.month)}var Aa=Ut({name:"QDate",props:{...ia,...Nt,...Yt,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Ne},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Ne},navigationMaxYearMonth:{type:String,validator:Ne},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:lt}},emits:[...da,"range-start","range-end","navigation"],setup(e,{slots:o,emit:u}){const{proxy:s}=jt(),{$q:i}=s,l=Ht(e,i),{getCache:y}=Kt(),{tabindex:d,headerClass:g,getLocale:O,getCurrentDate:m}=ca(e,i);let M;const R=kt(e),r=pt(R),f=p(null),w=p($e()),T=p(O()),U=I(()=>$e()),q=I(()=>O()),$=I(()=>m()),D=p(je(w.value,T.value)),N=p(e.defaultView),ke=i.lang.rtl===!0?"right":"left",ie=p(ke.value),Ae=p(ke.value),Ce=D.value.year,de=p(Ce-Ce%J-(Ce<0?J:0)),Y=p(null),ft=I(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(l.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),W=I(()=>e.color||"primary"),K=I(()=>e.textColor||"white"),ce=I(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),Ie=I(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),j=I(()=>Ie.value.filter(t=>typeof t=="string").map(t=>we(t,w.value,T.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),ee=I(()=>{const t=a=>we(a,w.value,T.value);return Ie.value.filter(a=>Pt(a)===!0&&a.from!==void 0&&a.to!==void 0).map(a=>({from:t(a.from),to:t(a.to)})).filter(a=>a.from.dateHash!==null&&a.to.dateHash!==null&&a.from.dateHash<a.to.dateHash)}),ve=I(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const a=Ke(t.year,t.month,t.day);return new Date(a.gy,a.gm-1,a.gd)}),Me=I(()=>e.calendar==="persian"?Z:(t,a,n)=>ya(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),a===void 0?w.value:a,n===void 0?T.value:n,t.year,t.timezoneOffset)),le=I(()=>j.value.length+ee.value.reduce((t,a)=>t+1+vt(ve.value(a.to),ve.value(a.from)),0)),pe=I(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length>0)return e.title;if(Y.value!==null){const n=Y.value.init,v=ve.value(n);return T.value.daysShort[v.getDay()]+", "+T.value.monthsShort[n.month-1]+" "+n.day+oe+"?"}if(le.value===0)return oe;if(le.value>1)return`${le.value} ${T.value.pluralDay}`;const t=j.value[0],a=ve.value(t);return isNaN(a.valueOf())===!0?oe:T.value.headerTitle!==void 0?T.value.headerTitle(a,t):T.value.daysShort[a.getDay()]+", "+T.value.monthsShort[t.month-1]+" "+t.day}),mt=I(()=>j.value.concat(ee.value.map(a=>a.from)).sort((a,n)=>a.year-n.year||a.month-n.month)[0]),ht=I(()=>j.value.concat(ee.value.map(a=>a.to)).sort((a,n)=>n.year-a.year||n.month-a.month)[0]),Le=I(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length>0)return e.subtitle;if(le.value===0)return oe;if(le.value>1){const t=mt.value,a=ht.value,n=T.value.monthsShort;return n[t.month-1]+(t.year!==a.year?" "+t.year+oe+n[a.month-1]+" ":t.month!==a.month?oe+n[a.month-1]:"")+" "+a.year}return j.value[0].year}),fe=I(()=>{const t=[i.iconSet.datetime.arrowLeft,i.iconSet.datetime.arrowRight];return i.lang.rtl===!0?t.reverse():t}),Fe=I(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):T.value.firstDayOfWeek),gt=I(()=>{const t=T.value.daysShort,a=Fe.value;return a>0?t.slice(a,7).concat(t.slice(0,a)):t}),B=I(()=>{const t=D.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():De(t.year,t.month)}),yt=I(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),H=I(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),k=I(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Te=I(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return H.value!==null&&H.value.year>=D.value.year&&(t.year.prev=!1,H.value.year===D.value.year&&H.value.month>=D.value.month&&(t.month.prev=!1)),k.value!==null&&k.value.year<=D.value.year&&(t.year.next=!1,k.value.year===D.value.year&&k.value.month<=D.value.month&&(t.month.next=!1)),t}),me=I(()=>{const t={};return j.value.forEach(a=>{const n=G(a);t[n]===void 0&&(t[n]=[]),t[n].push(a.day)}),t}),qe=I(()=>{const t={};return ee.value.forEach(a=>{const n=G(a.from),v=G(a.to);if(t[n]===void 0&&(t[n]=[]),t[n].push({from:a.from.day,to:n===v?a.to.day:void 0,range:a}),n<v){let c;const{year:b,month:h}=a.from,C=h<12?{year:b,month:h+1}:{year:b+1,month:1};for(;(c=G(C))<=v;)t[c]===void 0&&(t[c]=[]),t[c].push({from:void 0,to:c===v?a.to.day:void 0,range:a}),C.month++,C.month>12&&(C.year++,C.month=1)}}),t}),re=I(()=>{if(Y.value===null)return;const{init:t,initHash:a,final:n,finalHash:v}=Y.value,[c,b]=a<=v?[t,n]:[n,t],h=G(c),C=G(b);if(h!==V.value&&C!==V.value)return;const _={};return h===V.value?(_.from=c.day,_.includeFrom=!0):_.from=1,C===V.value?(_.to=b.day,_.includeTo=!0):_.to=B.value,_}),V=I(()=>G(D.value)),Dt=I(()=>{const t={};if(e.options===void 0){for(let n=1;n<=B.value;n++)t[n]=!0;return t}const a=typeof e.options=="function"?e.options:n=>e.options.includes(n);for(let n=1;n<=B.value;n++){const v=V.value+"/"+E(n);t[n]=a(v)}return t}),At=I(()=>{const t={};if(e.events===void 0)for(let a=1;a<=B.value;a++)t[a]=!1;else{const a=typeof e.events=="function"?e.events:n=>e.events.includes(n);for(let n=1;n<=B.value;n++){const v=V.value+"/"+E(n);t[n]=a(v)===!0&&yt.value(v)}}return t}),Ct=I(()=>{let t,a;const{year:n,month:v}=D.value;if(e.calendar!=="persian")t=new Date(n,v-1,1),a=new Date(n,v-1,0).getDate();else{const c=Ke(n,v,1);t=new Date(c.gy,c.gm-1,c.gd);let b=v-1,h=n;b===0&&(b=12,h--),a=De(h,b)}return{days:t.getDay()-Fe.value-1,endDay:a}}),Ve=I(()=>{const t=[],{days:a,endDay:n}=Ct.value,v=a<0?a+7:a;if(v<6)for(let h=n-v;h<=n;h++)t.push({i:h,fill:!0});const c=t.length;for(let h=1;h<=B.value;h++){const C={i:h,event:At.value[h],classes:[]};Dt.value[h]===!0&&(C.in=!0,C.flat=!0),t.push(C)}if(me.value[V.value]!==void 0&&me.value[V.value].forEach(h=>{const C=c+h-1;Object.assign(t[C],{selected:!0,unelevated:!0,flat:!1,color:W.value,textColor:K.value})}),qe.value[V.value]!==void 0&&qe.value[V.value].forEach(h=>{if(h.from!==void 0){const C=c+h.from-1,_=c+(h.to||B.value)-1;for(let Re=C;Re<=_;Re++)Object.assign(t[Re],{range:h.range,unelevated:!0,color:W.value,textColor:K.value});Object.assign(t[C],{rangeFrom:!0,flat:!1}),h.to!==void 0&&Object.assign(t[_],{rangeTo:!0,flat:!1})}else if(h.to!==void 0){const C=c+h.to-1;for(let _=c;_<=C;_++)Object.assign(t[_],{range:h.range,unelevated:!0,color:W.value,textColor:K.value});Object.assign(t[C],{flat:!1,rangeTo:!0})}else{const C=c+B.value-1;for(let _=c;_<=C;_++)Object.assign(t[_],{range:h.range,unelevated:!0,color:W.value,textColor:K.value})}}),re.value!==void 0){const h=c+re.value.from-1,C=c+re.value.to-1;for(let _=h;_<=C;_++)t[_].color=W.value,t[_].editRange=!0;re.value.includeFrom===!0&&(t[h].editRangeFrom=!0),re.value.includeTo===!0&&(t[C].editRangeTo=!0)}D.value.year===$.value.year&&D.value.month===$.value.month&&(t[c+$.value.day-1].today=!0);const b=t.length%7;if(b>0){const h=7-b;for(let C=1;C<=h;C++)t.push({i:C,fill:!0})}return t.forEach(h=>{let C="q-date__calendar-item ";h.fill===!0?C+="q-date__calendar-item--fill":(C+=`q-date__calendar-item--${h.in===!0?"in":"out"}`,h.range!==void 0&&(C+=` q-date__range${h.rangeTo===!0?"-to":h.rangeFrom===!0?"-from":""}`),h.editRange===!0&&(C+=` q-date__edit-range${h.editRangeFrom===!0?"-from":""}${h.editRangeTo===!0?"-to":""}`),(h.range!==void 0||h.editRange===!0)&&(C+=` text-${h.color}`)),h.classes=C}),t}),It=I(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});ne(()=>e.modelValue,t=>{if(M===t)M=0;else{const{year:a,month:n}=je(w.value,T.value);te(a,n)}}),ne(N,()=>{f.value!==null&&f.value.focus()}),ne(()=>D.value.year,t=>{u("navigation",{year:t,month:D.value.month})}),ne(()=>D.value.month,t=>{u("navigation",{year:D.value.year,month:t})}),ne(U,t=>{Ge(t,T.value,"mask"),w.value=t}),ne(q,t=>{Ge(w.value,t,"locale"),T.value=t});function Ue(){const t=$.value,a=me.value[G(t)];(a===void 0||a.includes(t.day)===!1)&&Se(t),be(t.year,t.month)}function Mt(t){lt(t)===!0&&(N.value=t)}function Tt(t,a){["month","year"].includes(t)&&(t==="month"?Be:Ee)(a===!0?-1:1)}function be(t,a){N.value="Calendar",te(t,a)}function bt(t,a){if(e.range===!1||!t){Y.value=null;return}const n=Object.assign({...D.value},t),v=a!==void 0?Object.assign({...D.value},a):n;Y.value={init:n,initHash:Z(n),final:v,finalHash:Z(v)},be(n.year,n.month)}function $e(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function we(t,a,n){return ga(t,a,n,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function je(t,a){const n=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(n.length===0)return Pe();const v=n[n.length-1],c=we(v.from!==void 0?v.from:v,t,a);return c.dateHash===null?Pe():c}function Pe(){let t,a;if(e.defaultYearMonth!==void 0){const n=e.defaultYearMonth.split("/");t=parseInt(n[0],10),a=parseInt(n[1],10)}else{const n=$.value!==void 0?$.value:m();t=n.year,a=n.month}return{year:t,month:a,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+E(a)+"/01"}}function Be(t){let a=D.value.year,n=Number(D.value.month)+t;n===13?(n=1,a++):n===0&&(n=12,a--),te(a,n),ce.value===!0&&he("month")}function Ee(t){const a=Number(D.value.year)+t;te(a,D.value.month),ce.value===!0&&he("year")}function wt(t){te(t,D.value.month),N.value=e.defaultView==="Years"?"Months":"Calendar",ce.value===!0&&he("year")}function Et(t){te(D.value.year,t),N.value="Calendar",ce.value===!0&&he("month")}function St(t,a){const n=me.value[a];(n!==void 0&&n.includes(t.day)===!0?_e:Se)(t)}function X(t){return{year:t.year,month:t.month,day:t.day}}function te(t,a){H.value!==null&&t<=H.value.year&&(t=H.value.year,a<H.value.month&&(a=H.value.month)),k.value!==null&&t>=k.value.year&&(t=k.value.year,a>k.value.month&&(a=k.value.month));const n=t+"/"+E(a)+"/01";n!==D.value.dateHash&&(ie.value=D.value.dateHash<n==(i.lang.rtl!==!0)?"left":"right",t!==D.value.year&&(Ae.value=ie.value),We(()=>{de.value=t-t%J-(t<0?J:0),Object.assign(D.value,{year:t,month:a,day:1,dateHash:n})}))}function Qe(t,a,n){const v=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;M=v;const{reason:c,details:b}=Ze(a,n);u("update:modelValue",v,c,b)}function he(t){const a=j.value[0]!==void 0&&j.value[0].dateHash!==null?{...j.value[0]}:{...D.value};We(()=>{a.year=D.value.year,a.month=D.value.month;const n=e.calendar!=="persian"?new Date(a.year,a.month,0).getDate():De(a.year,a.month);a.day=Math.min(Math.max(1,a.day),n);const v=ae(a);M=v;const{details:c}=Ze("",a);u("update:modelValue",v,t,c)})}function Ze(t,a){return a.from!==void 0?{reason:`${t}-range`,details:{...X(a.target),from:X(a.from),to:X(a.to)}}:{reason:`${t}-day`,details:X(a)}}function ae(t,a,n){return t.from!==void 0?{from:Me.value(t.from,a,n),to:Me.value(t.to,a,n)}:Me.value(t,a,n)}function Se(t){let a;if(e.multiple===!0)if(t.from!==void 0){const n=Z(t.from),v=Z(t.to),c=j.value.filter(h=>h.dateHash<n||h.dateHash>v),b=ee.value.filter(({from:h,to:C})=>C.dateHash<n||h.dateHash>v);a=c.concat(b).concat(t).map(h=>ae(h))}else{const n=Ie.value.slice();n.push(ae(t)),a=n}else a=ae(t);Qe(a,"add",t)}function _e(t){if(e.noUnset===!0)return;let a=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const n=ae(t);t.from!==void 0?a=e.modelValue.filter(v=>v.from!==void 0?v.from!==n.from&&v.to!==n.to:!0):a=e.modelValue.filter(v=>v!==n),a.length===0&&(a=null)}Qe(a,"remove",t)}function Ge(t,a,n){const v=j.value.concat(ee.value).map(c=>ae(c,t,a)).filter(c=>c.from!==void 0?c.from.dateHash!==null&&c.to.dateHash!==null:c.dateHash!==null);u("update:modelValue",(e.multiple===!0?v:v[0])||null,n)}function _t(){if(e.minimal!==!0)return A("div",{class:"q-date__header "+g.value},[A("div",{class:"relative-position"},[A(se,{name:"q-transition--fade"},()=>A("div",{key:"h-yr-"+Le.value,class:"q-date__header-subtitle q-date__header-link "+(N.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:d.value,...y("vY",{onClick(){N.value="Years"},onKeyup(t){t.keyCode===13&&(N.value="Years")}})},[Le.value]))]),A("div",{class:"q-date__header-title relative-position flex no-wrap"},[A("div",{class:"relative-position col"},[A(se,{name:"q-transition--fade"},()=>A("div",{key:"h-sub"+pe.value,class:"q-date__header-title-label q-date__header-link "+(N.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:d.value,...y("vC",{onClick(){N.value="Calendar"},onKeyup(t){t.keyCode===13&&(N.value="Calendar")}})},[pe.value]))]),e.todayBtn===!0?A(L,{class:"q-date__header-today self-start",icon:i.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:d.value,onClick:Ue}):null])])}function Oe({label:t,type:a,key:n,dir:v,goTo:c,boundaries:b,cls:h}){return[A("div",{class:"row items-center q-date__arrow"},[A(L,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[0],tabindex:d.value,disable:b.prev===!1,...y("go-#"+a,{onClick(){c(-1)}})})]),A("div",{class:"relative-position overflow-hidden flex flex-center"+h},[A(se,{name:"q-transition--jump-"+v},()=>A("div",{key:n},[A(L,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:d.value,...y("view#"+a,{onClick:()=>{N.value=a}})})]))]),A("div",{class:"row items-center q-date__arrow"},[A(L,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[1],tabindex:d.value,disable:b.next===!1,...y("go+#"+a,{onClick(){c(1)}})})])]}const Ot={Calendar:()=>[A("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[A("div",{class:"q-date__navigation row items-center no-wrap"},Oe({label:T.value.months[D.value.month-1],type:"Months",key:D.value.month,dir:ie.value,goTo:Be,boundaries:Te.value.month,cls:" col"}).concat(Oe({label:D.value.year,type:"Years",key:D.value.year,dir:Ae.value,goTo:Ee,boundaries:Te.value.year,cls:""}))),A("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},gt.value.map(t=>A("div",{class:"q-date__calendar-item"},[A("div",t)]))),A("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[A(se,{name:"q-transition--slide-"+ie.value},()=>A("div",{key:V.value,class:"q-date__calendar-days fit"},Ve.value.map(t=>A("div",{class:t.classes},[t.in===!0?A(L,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:d.value,...y("day#"+t.i,{onClick:()=>{Rt(t.i)},onMouseover:()=>{xt(t.i)}})},t.event!==!1?()=>A("div",{class:"q-date__event bg-"+t.event}):null):A("div",""+t.i)]))))])])],Months(){const t=D.value.year===$.value.year,a=v=>H.value!==null&&D.value.year===H.value.year&&H.value.month>v||k.value!==null&&D.value.year===k.value.year&&k.value.month<v,n=T.value.monthsShort.map((v,c)=>{const b=D.value.month===c+1;return A("div",{class:"q-date__months-item flex flex-center"},[A(L,{class:t===!0&&$.value.month===c+1?"q-date__today":null,flat:b!==!0,label:v,unelevated:b,color:b===!0?W.value:null,textColor:b===!0?K.value:null,tabindex:d.value,disable:a(c+1),...y("month#"+c,{onClick:()=>{Et(c+1)}})})])});return e.yearsInMonthView===!0&&n.unshift(A("div",{class:"row no-wrap full-width"},[Oe({label:D.value.year,type:"Years",key:D.value.year,dir:Ae.value,goTo:Ee,boundaries:Te.value.year,cls:" col"})])),A("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const t=de.value,a=t+J,n=[],v=c=>H.value!==null&&H.value.year>c||k.value!==null&&k.value.year<c;for(let c=t;c<=a;c++){const b=D.value.year===c;n.push(A("div",{class:"q-date__years-item flex flex-center"},[A(L,{key:"yr"+c,class:$.value.year===c?"q-date__today":null,flat:!b,label:c,dense:!0,unelevated:b,color:b===!0?W.value:null,textColor:b===!0?K.value:null,tabindex:d.value,disable:v(c),...y("yr#"+c,{onClick:()=>{wt(c)}})})]))}return A("div",{class:"q-date__view q-date__years flex flex-center"},[A("div",{class:"col-auto"},[A(L,{round:!0,dense:!0,flat:!0,icon:fe.value[0],tabindex:d.value,disable:v(t),...y("y-",{onClick:()=>{de.value-=J}})})]),A("div",{class:"q-date__years-content col self-stretch row items-center"},n),A("div",{class:"col-auto"},[A(L,{round:!0,dense:!0,flat:!0,icon:fe.value[1],tabindex:d.value,disable:v(a),...y("y+",{onClick:()=>{de.value+=J}})})])])}};function Rt(t){const a={...D.value,day:t};if(e.range===!1){St(a,V.value);return}if(Y.value===null){const n=Ve.value.find(c=>c.fill!==!0&&c.i===t);if(e.noUnset!==!0&&n.range!==void 0){_e({target:a,from:n.range.from,to:n.range.to});return}if(n.selected===!0){_e(a);return}const v=Z(a);Y.value={init:a,initHash:v,final:a,finalHash:v},u("range-start",X(a))}else{const n=Y.value.initHash,v=Z(a),c=n<=v?{from:Y.value.init,to:a}:{from:a,to:Y.value.init};Y.value=null,Se(n===v?a:{target:a,...c}),u("range-end",{from:X(c.from),to:X(c.to)})}}function xt(t){if(Y.value!==null){const a={...D.value,day:t};Object.assign(Y.value,{final:a,finalHash:Z(a)})}}return Object.assign(s,{setToday:Ue,setView:Mt,offsetCalendar:Tt,setCalendarTo:be,setEditingRange:bt}),()=>{const t=[A("div",{class:"q-date__content col relative-position"},[A(se,{name:"q-transition--fade"},Ot[N.value])])],a=$t(o.default);return a!==void 0&&t.push(A("div",{class:"q-date__actions"},a)),e.name!==void 0&&e.disable!==!0&&r(t,"push"),A("div",{class:ft.value,...It.value},[_t(),A("div",{ref:f,class:"q-date__main col column",tabindex:-1},t)])}}});const Ca={class:"text-center text-h6 text-bold"},Ia={class:"row"},Ma={class:"q-pa-md"},Ta=ye("div",{class:"q-pb-sm"},null,-1),ka={__name:"Report",setup(e){const o=Lt();Zt();const u=p({workpoints:[],cedis:null,val:null}),s=p(!1),i=p(null),l=p({salidas:null,entradas:null}),y=p({rows:[],filter:""}),d=async()=>{let R=new Date,r=ta(R).format("YYYY/MM/DD");i.value=r,console.log(r);const f=await Je.getStores();f.status==200?(console.log(f.data),u.value.workpoints=f.data,u.value.cedis=f.data.filter(w=>w.id==1)[0]):console.log(f)},g=async()=>{y.value.rows=[],o.loading.show({message:"Obteniendo datos"});let R={cedis:u.value.cedis,sucursal:u.value.val,fechas:i.value};console.log(R);const r=await Je.getData(R);console.log(r),r.status==200?(console.log(r.data),l.value.salidas=r.data.salidas,l.value.entradas=r.data.entradas,o.loading.hide(),O()):alert(r)},O=()=>{o.loading.show({message:"Haciendo Match"}),l.value.entradas.sort((r,f)=>f.ARTICULOS!==r.ARTICULOS?f.ARTICULOS.localeCompare(r.ARTICULOS):f.SALIDA.localeCompare(r.SALIDA)),l.value.salidas.sort((r,f)=>f.ARTICULOS!==r.ARTICULOS?f.ARTICULOS.localeCompare(r.ARTICULOS):f.FACTURA.localeCompare(r.FACTURA));const R=new Set;l.value.entradas.forEach(r=>{const f=l.value.salidas.find((w,T)=>{const U=w.ARTICULOS===r.ARTICULOS&&"FAC "+w.FACTURA===r.SALIDA;return U&&R.add(T),U});if(f){const w=r.CANTIDAD*r.PRECIO,T=f.CANTIDAD*f.PRECIO,U=f.ARTICULOS===r.ARTICULOS,q=f.CANTIDAD===r.CANTIDAD,$=f.PRECIO===r.PRECIO,D=T===w;y.value.rows.push({SALIDA:f.FACTURA,FECHA:f.FECHAYHORA,REFERENCIA:f.REFERENCIA,CLIENTE:f.NOMBRECLIENTE,CODIGO:f.ARTICULOS,DESCRIPCION:f.DESCRIPCION,CANTIDAD:Number(f.CANTIDAD).toFixed(2),PRECIO:Number(f.PRECIO).toFixed(2),TOTAL:Number(T).toFixed(2),codigoIGUAL:U?"verdadero":"falso",CANTIDADIGUAL:q?"verdadero":"falso",PRECIOIGUAL:$?"verdadero":"falso",TOTALIGUAL:D?"verdadero":"falso",ENTRADA:r.FACTURA,ENTRADA_SALIDA:r.SALIDA,ENTRADA_FECHA:r.FECHA,ENTRADA_CODIGO:r.ARTICULOS,ENTRADA_DESCRIPCION:r.DESCRIPCION,ENTRADA_CANTIDAD:Number(r.CANTIDAD).toFixed(2),ENTRADA_PRECIO:Number(r.PRECIO).toFixed(2),ENTRADA_TOTAL:Number(w).toFixed(2)});const N=l.value.salidas.indexOf(f);N>-1&&l.value.salidas.splice(N,1)}else{const w=r.CANTIDAD*r.PRECIO;y.value.rows.push({SALIDA:"",FECHA:"",REFERENCIA:"",CLIENTE:"",CODIGO:"",DESCRIPCION:"",CANTIDAD:"",PRECIO:"",TOTAL:"",codigoIGUAL:!1,CANTIDADIGUAL:!1,PRECIOIGUAL:!1,TOTALIGUAL:!1,ENTRADA:r.FACTURA,ENTRADA_SALIDA:r.SALIDA,ENTRADA_FECHA:r.FECHA,ENTRADA_CODIGO:r.ARTICULOS,ENTRADA_DESCRIPCION:r.DESCRIPCION,ENTRADA_CANTIDAD:Number(r.CANTIDAD).toFixed(2),ENTRADA_PRECIO:Number(r.PRECIO).toFixed(2),ENTRADA_TOTAL:Number(w).toFixed(2)})}}),l.value.salidas.forEach((r,f)=>{if(!R.has(f)){const w=r.CANTIDAD*r.PRECIO;y.value.rows.push({SALIDA:r.FACTURA,FECHA:r.FECHAYHORA,REFERENCIA:r.REFERENCIA,CLIENTE:r.NOMBRECLIENTE,CODIGO:r.ARTICULOS,DESCRIPCION:r.DESCRIPCION,CANTIDAD:Number(r.CANTIDAD).toFixed(2),PRECIO:Number(r.PRECIO).toFixed(2),TOTAL:Number(w).toFixed(2),codigoIGUAL:!1,CANTIDADIGUAL:!1,PRECIOIGUAL:!1,TOTALIGUAL:!1,ENTRADA:"",ENTRADA_SALIDA:"",ENTRADA_FECHA:"",ENTRADA_CODIGO:"",ENTRADA_DESCRIPCION:"",ENTRADA_CANTIDAD:"",ENTRADA_PRECIO:"",ENTRADA_TOTAL:""})}}),o.loading.hide()},m=async()=>{console.log(i.value),s.value=!1,u.value.val=null,y.value.rows=[]},M=async()=>{const R=new aa.Workbook,r=R.addWorksheet(`Comparativo ${u.value.val.name}`);console.log(),r.addTable({name:"Comparativo",ref:"A1",headerRow:!0,totalsRow:!1,style:{showRowStripes:!0},columns:Object.keys(y.value.rows[0]).map(w=>({name:w,filterButton:!0})),rows:y.value.rows.map(w=>Object.values(w))}),r.columns.forEach(w=>{let T=0;w.eachCell({includeEmpty:!0},U=>{const q=U.value?U.value.toString().length:10;q>T&&(T=q)}),w.width=T<10?10:T}),(async()=>{const w=await R.xlsx.writeBuffer(),T=new Blob([w],{type:"application/octet-stream"}),U=URL.createObjectURL(T),q=document.createElement("a");q.href=U,q.download=`Comparativo ${u.value.val.name} ${typeof i.value=="object"?`Del ${i.value.from} a ${i.value.to}`:i.value}.xlsx`,document.body.appendChild(q),q.click(),document.body.removeChild(q)})()};return d(),(R,r)=>(Bt(),Qt(ea,{padding:""},{default:Q(()=>[ye("div",Ca,"Reporte "+Gt(typeof i.value=="object"?`Del ${i.value.from} a
      ${i.value.to}`:i.value),1),x(ue,{spaced:"",inset:"",vertical:"",dark:""}),ye("div",Ia,[x(L,{color:"primary",icon:"event",onClick:r[0]||(r[0]=f=>s.value=!s.value),flat:"",rounded:""}),x(ue,{spaced:"",inset:"",vertical:"",dark:""}),x(ze,{modelValue:u.value.cedis,"onUpdate:modelValue":r[1]||(r[1]=f=>u.value.cedis=f),options:u.value.workpoints,label:"Cedis",class:"col","option-label":"name",disable:!0,outlined:""},null,8,["modelValue","options"]),x(ue,{spaced:"",inset:"",vertical:"",dark:""}),x(ze,{modelValue:u.value.val,"onUpdate:modelValue":[r[2]||(r[2]=f=>u.value.val=f),g],options:u.value.workpoints,label:"Sucursal",class:"col","option-label":"name",outlined:"","option-disable":f=>f.id==1},null,8,["modelValue","options","option-disable"])]),x(ue,{spaced:"",inset:"",vertical:"",dark:""}),x(Ft,{title:"Comparativo",rows:y.value.rows,filter:y.value.filter},{"top-right":Q(()=>[x(Wt,{borderless:"",dense:"",debounce:"300",modelValue:y.value.filter,"onUpdate:modelValue":r[3]||(r[3]=f=>y.value.filter=f),placeholder:"Buscar"},{append:Q(()=>[x(zt,{name:"search"})]),_:1},8,["modelValue"]),x(ue,{spaced:"",inset:"",vertical:"",dark:""}),x(L,{color:"primary",icon:"ios_share",onClick:M,flat:"",disable:y.value.rows.length<=0},null,8,["disable"])]),_:1},8,["rows","filter"]),x(qt,{modelValue:s.value,"onUpdate:modelValue":r[6]||(r[6]=f=>s.value=f)},{default:Q(()=>[x(Xt,{class:"my-card"},{default:Q(()=>[x(Xe,null,{default:Q(()=>[ye("div",Ma,[Ta,x(Aa,{modelValue:i.value,"onUpdate:modelValue":r[4]||(r[4]=f=>i.value=f),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),x(Xe,null,{default:Q(()=>[x(Jt,{align:"right"},{default:Q(()=>[x(L,{flat:"",icon:"close",color:"negative",onClick:r[5]||(r[5]=f=>s.value=!s.value)}),x(L,{flat:"",icon:"check",color:"positive",onClick:m})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ka as default};
